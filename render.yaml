services:
  # Frontend - Static Site
  - type: web
    name: delhibreathe-frontend
    env: static
    buildCommand: npm install && npm run build
    staticPublishPath: ./dist
    envVars:
      - key: NODE_VERSION
        value: 18
    # Add your Firebase config as environment variables
    # - key: VITE_FIREBASE_API_KEY
    #   sync: false
    # - key: VITE_FIREBASE_AUTH_DOMAIN
    #   sync: false
    # - key: VITE_FIREBASE_PROJECT_ID
    #   sync: false
    # - key: VITE_FIREBASE_STORAGE_BUCKET
    #   sync: false
    # - key: VITE_FIREBASE_MESSAGING_SENDER_ID
    #   sync: false
    # - key: VITE_FIREBASE_APP_ID
    #   sync: false

  # Backend API - Node.js Service
  - type: web
    name: delhibreathe-api
    env: node
    region: oregon
    plan: starter
    buildCommand: cd functions && npm install
    startCommand: cd functions && node index.js
    envVars:
      - key: NODE_VERSION
        value: 24
      - key: PORT
        value: 3000
    # Add Firebase Admin SDK credentials
    # - key: FIREBASE_SERVICE_ACCOUNT
    #   sync: false

  # ML Service - Python
  - type: web
    name: delhibreathe-ml
    env: python
    region: oregon
    plan: starter
    buildCommand: cd functions/ml && pip install -r requirements.txt
    startCommand: cd functions/ml && python main.py
    envVars:
      - key: PYTHON_VERSION
        value: 3.11
      - key: PORT
        value: 5000
    # Add any ML service specific env vars
    # - key: MODEL_PATH
    #   value: ./aqi_lstm_best.h5
